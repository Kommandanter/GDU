scripted_diplomatic_actions = {

	EAI_stockpile_diplomacy = {
	
        allowed = { always = yes }

        visible = { 
            OR = { 
                FROM = { OR = { is_in_faction_with = ROOT is_subject_of = ROOT } }
                ROOT = { is_subject_of = FROM } 
                FROM = { has_war_together_with = ROOT }
                AND = {
					FROM = { has_government = ROOT }
					NOT = { has_government = neutrality }
				}
            }
        }

        selectable = { 
            NOT = { 
                ROOT = { has_country_flag = EAI_config_STOCKPILE } 
                ROOT = { has_country_flag = EAI_stockpile_diplomacy_REQUESTED }
            } 
        }

        icon = 1

        on_sent_effect = {
            ROOT = { set_country_flag = { flag = EAI_stockpile_diplomacy_REQUESTED value = 1 days = 2 } }
		}

        complete_effect = {
            
            ROOT = { 
                clr_country_flag = EAI_stockpile_diplomacy_REQUESTED

                EAI_set_stockpile_variables = yes
                set_country_flag = EAI_config_STOCKPILE 
            }

            FROM = { set_variable = { ROOT.EAI_configuration_target = THIS.id } }
		}

        ai_acceptance = {
			EAI_diplomacy_action_opinion_modifier = {
                base = 0

                modifier = {
                    add = 1
                    FROM = { has_opinion = { target = ROOT value > 50 } }
                }
            }
            DR_FACTION_SAME_WAR = {
                base = 0

                modifier = {
                    add = 1
                    FROM = { has_war_together_with = ROOT }
                }
            }
		}

        ai_desire = {
			factor = -1
		}
	}

}