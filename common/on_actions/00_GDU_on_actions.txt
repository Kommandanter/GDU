on_actions = {

	on_startup = {
		effect = {
		
			#Initializing the global.small_airbase_list array#
	
		if = { 
			limit = { 
				NOT = { has_global_flag = airbase_list_created } 
			}
			set_global_flag = airbase_list_created 
			
            ## Andachal land airfield
            add_to_array = { global.small_airbase_list = 434 } #Andachal-tibet-china-india contested zone,Contested zone 

			###Pacific Islands### 
			
			add_to_array = { global.small_airbase_list = 646 } #Saipan, JAP, Small Island 
			add_to_array = { global.small_airbase_list = 638 } #Guam, USA, 
			add_to_array = { global.small_airbase_list = 647 } #Palau, JAP 
			add_to_array = { global.small_airbase_list = 633 } #Marshall Islands, JAP 
			add_to_array = { global.small_airbase_list = 639 } #Gilbert Islands, UK 
			add_to_array = { global.small_airbase_list = 725 } #Nauru, AST 
			add_to_array = { global.small_airbase_list = 643 } #Ellice Islands, UK 
			add_to_array = { global.small_airbase_list = 734 } #Nendo, France 
			add_to_array = { global.small_airbase_list = 636 } #Fiji, NZL 
			add_to_array = { global.small_airbase_list = 726 } #Samoa, NZL 
			add_to_array = { global.small_airbase_list = 642 } #Phoenix Island, USA 
			add_to_array = { global.small_airbase_list = 727 } #Line islands, USA 
			add_to_array = { global.small_airbase_list = 641 } #Tahiti, FRA 
			add_to_array = { global.small_airbase_list = 270 } #Pitcairn Island, UK 
			add_to_array = { global.small_airbase_list = 630 } #Johnston Atoll, USA 
			add_to_array = { global.small_airbase_list = 631 } #Midway Island, USA 
			add_to_array = { global.small_airbase_list = 632 } #Wake Island, USA 
			add_to_array = { global.small_airbase_list = 648 } #Marcus Island, JAP 
			add_to_array = { global.small_airbase_list = 555 } #Kuril Islands, JAP
			add_to_array = { global.small_airbase_list = 650 } #Attu Island, USA 
			add_to_array = { global.small_airbase_list = 684 } #Caroline islands, JAP, LglobalE chain
			add_to_array = { global.small_airbase_list = 797 } #Yap Islands, JAP, used to be part of 684 in mod 
			add_to_array = { global.small_airbase_list = 798 } #Truk Islands, JAP, used to be part of 684 in mod 
		
			###Indian Ocean###
		
			add_to_array = { global.small_airbase_list = 733 } #Andaman, UK 
			add_to_array = { global.small_airbase_list = 712 } #Cocos, UK 
			add_to_array = { global.small_airbase_list = 711 } #Christmas Island, UK 
			add_to_array = { global.small_airbase_list = 710 } #Diego Garcia, UK 
			add_to_array = { global.small_airbase_list = 281 } #Maldives, UK 
			add_to_array = { global.small_airbase_list = 709 } #Seychelles, UK 
			add_to_array = { global.small_airbase_list = 707 } #Mauritius, UK 
			add_to_array = { global.small_airbase_list = 706 } #Reunion, FRA 
			add_to_array = { global.small_airbase_list = 708 } #Comoros, FRA 
			add_to_array = { global.small_airbase_list = 713 } #Kerguelen, FRA 
		
			###Atlantic###
		
			add_to_array = { global.small_airbase_list = 704 } #Saint Helena, UK 
			add_to_array = { global.small_airbase_list = 703 } #Ascension, UK 
			add_to_array = { global.small_airbase_list = 299 } #Falklands, UK 
			add_to_array = { global.small_airbase_list = 720 } #South Georgia, UK 
			add_to_array = { global.small_airbase_list = 702 } #Cape Verde, POR 
			add_to_array = { global.small_airbase_list = 178 } #Canary Islands, SPR 
			add_to_array = { global.small_airbase_list = 697 } #Madeira, POR 
			add_to_array = { global.small_airbase_list = 696 } #Bermuda, UK 
			add_to_array = { global.small_airbase_list = 337 } #Faroes, DEN-UK
			
			###Caribbean###
		
			add_to_array = { global.small_airbase_list = 690 } #Bahamas, UK 
			add_to_array = { global.small_airbase_list = 693 } #Southern Bahamas, UK 
			add_to_array = { global.small_airbase_list = 689 } #Jamaica, UK 
			add_to_array = { global.small_airbase_list = 692 } #Windward Islands, UK
			add_to_array = { global.small_airbase_list = 691 } #Trinidad, UK 
			add_to_array = { global.small_airbase_list = 308 } #Leeward Islands, UK 
			add_to_array = { global.small_airbase_list = 694 } #French Caribbean, FRA 
			add_to_array = { global.small_airbase_list = 686 } #Puerto Rico, USA
		
			#Initializing the global.medium_airbase_list array# 
	
			### Philippines ### 
		
			add_to_array = { global.medium_airbase_list = 327 } #Manila, PHI 
			add_to_array = { global.medium_airbase_list = 623 } #Luzon, PHI 
			add_to_array = { global.medium_airbase_list = 624 } #Central Islands, PHI 
			add_to_array = { global.medium_airbase_list = 628 } #Cebu, PHI 
			add_to_array = { global.medium_airbase_list = 625 } #Samar, PHI 
			add_to_array = { global.medium_airbase_list = 627 } #Mindanao, PHI 
			add_to_array = { global.medium_airbase_list = 626 } #Palawan, PHI 
		
			### Home Islands of Japan ### 
		
			add_to_array = { global.medium_airbase_list = 645 } #Iwo Jima, JAP 
		
			#### Borneo sucks. It's a jungle, mostly. ####
		
			add_to_array = { global.medium_airbase_list = 333 } #North Borneo, UK 
			add_to_array = { global.medium_airbase_list = 334 } #Kalimantan, INS--->UK 
			add_to_array = { global.medium_airbase_list = 793 } #Borneo Jungle, INS--->UK (should not be built on anyway, just to make sure though) 
		
			#### New Guinea sucks, but is very big so you can build 3 airbases on it. ####
		
			add_to_array = { global.medium_airbase_list = 669 } #West Papua, INS--->AST 
			add_to_array = { global.medium_airbase_list = 523 } #Papua, AST 
			add_to_array = { global.medium_airbase_list = 792 } #Central Papua, AST, should not be built in anyway. 
			add_to_array = { global.medium_airbase_list = 634 } #Soloman Islands, AST 
			add_to_array = { global.medium_airbase_list = 737 } #Bismarck, AST 
		
			#### Madagascar. May be relevant one day, who knows... ####
		
			add_to_array = { global.medium_airbase_list = 543 } #Madagascar, FRA 
		
			#### East Indies #### 
		
			add_to_array = { global.medium_airbase_list = 672 } #Sumatra, INS--->UK 
			add_to_array = { global.medium_airbase_list = 335 } #Java, INS--->UK 
			add_to_array = { global.medium_airbase_list = 673 } #Sulawesi, INS---> UK 
			add_to_array = { global.medium_airbase_list = 668 } #Moluccas, INS---> UK 
		
			#### Aru Islands ####
		
			add_to_array = { global.medium_airbase_list = 738 } #Aru Islands, INS ---> AST 
		
			#### Timor ####
		
			add_to_array = { global.medium_airbase_list = 721 } #Portuguese Timor, POR----> UK 
			add_to_array = { global.medium_airbase_list = 667 } #Lesser Sunda Islands, INS---> UK 
		
			#### Caledonia #### 
		
			add_to_array = { global.medium_airbase_list = 635 } #New Caledonia, FRA 
		
			#### Panama #### 
		
			add_to_array = { global.medium_airbase_list = 685 } #Panama Canal, USA (oh yeah I did)

		}
			







			
			

			##### Events that add national spirits to increase air losses a bit in the late game (for 1942, 1943, 1944, and 1945) ####
			VEN = {
				country_event = { id = gduairlosses.1 days = 2192 } 
			}
			VEN = {
				country_event = { id = gduairlosses.2 days = 2557 } 
			}
			VEN = {
				country_event = { id = gduairlosses.3 days = 2922 } 
			}
			VEN = {
				country_event = { id = gduairlosses.4 days = 3287 } 
			}			

					
			
			#### We give Japan Siam's rubber because the AI isn't going to trade Germany back and now we need one less player to start the game. ####
			SIA = {
				give_resource_rights = { receiver = JAP state = 724 }
				give_resource_rights = { receiver = JAP state = 289 }
			}
			##### Soviet event to remind/explain that they get a bonus for the 7th land doctrine into an on_startup event instead of MTTH to help performance####
			SOV = {
				country_event = { id = gduevents.28 days = 1582 } 
			}		
			##### Turning King Edward's abdication into an on_startup event instead of MTTH to help performance####
			ENG = {
				country_event = { id = britain.16 days = 20 } 
				country_event = { id = mtg_britain.1 days = 190 }			
			}
			#### EVENT EXPLAINING Purge mechanics to Soviets #### 
			SOV = { 
				country_event = { id = gduevents.21 days = 5 } 
			}
			#### EVENT EXPLAINING Sealion Mechanic to UK #### 
			ENG = { 
				country_event = { id = gduevents.27 days = 5 } 
				}
			#### EVENT for USA to remove Congress mechanic (or not) #### 			
			USA = { 
				country_event = { id = gduevents.23 days = 5 } 
			}			
			#### Intro event for Japan #### 
			JAP = { 
				country_event = { id = pfu.28 days = 30 } 
			}
			#### Strike event for France no longer MTTH #### 
			FRA = { 
				country_event = { id = france.21 days = 180 } 
			}
			#### The UK had a commanding stake in Iranian and Iraqi oil, as well as Venezuela. We don't give them Venezuela for balance reasons. Actually, as of 5/9/2019, we do--Removal of Strike Force from UK denial capability means they have to actually patrol and need more oil. ####
			PER = {
				give_resource_rights = { receiver = ENG state = 412 }
				give_resource_rights = { receiver = ENG state = 413 }
				give_resource_rights = { receiver = ENG state = 411 }
			}
			IRQ = { 
				give_resource_rights = { receiver = ENG state = 676 }
				give_resource_rights = { receiver = ENG state = 291 }
			}
			VEN = { 
				give_resource_rights = { receiver = ENG state = 489 }
				give_resource_rights = { receiver = ENG state = 307 } 				
			}
			#### The USA is given control over Philippines resources since it is a puppet. This gives USA some rubber and prevents USA from purposely importing too much rubber from UK just for trade-buffing reasons. Later on it perhaps also gives USA a bit more of an incentive to defend the Philippines since USA gets the rubber there itself. ####
			PHI = {
				give_resource_rights = { receiver = USA state = 623 }
				give_resource_rights = { receiver = USA state = 327 }
				give_resource_rights = { receiver = USA state = 626 }
				give_resource_rights = { receiver = USA state = 624 }
				give_resource_rights = { receiver = USA state = 625 }
				give_resource_rights = { receiver = USA state = 628 }
				give_resource_rights = { receiver = USA state = 627 }
			}		
			#### The Spanish Civil war as a non-MTTH event. #### 
			SPR = { 
				country_event = { id = spain.10 days = 185 } 
			}
			### Opinion modifiers so possible AI minors trade with right people 
			GER = { 
				add_opinion_modifier = { target = BUL modifier = huge_increase  }
				add_opinion_modifier = { target = BUL modifier = huge_increase  }
				add_opinion_modifier = { target = BUL modifier = huge_increase  }
				add_opinion_modifier = { target = FIN modifier = huge_increase  }
				add_opinion_modifier = { target = FIN modifier = huge_increase  }
				add_opinion_modifier = { target = FIN modifier = huge_increase  }
			}
			BUL = { 
				add_opinion_modifier = { target = GER modifier = huge_increase  }
				add_opinion_modifier = { target = GER modifier = huge_increase  }
				add_opinion_modifier = { target = GER modifier = huge_increase  }
			}
			FIN = { 
				add_opinion_modifier = { target = GER modifier = huge_increase  }
				add_opinion_modifier = { target = GER modifier = huge_increase  }
				add_opinion_modifier = { target = GER modifier = huge_increase  }
			}
			NZL = { 
				add_opinion_modifier = { target = AST modifier = huge_increase  }
				add_opinion_modifier = { target = AST modifier = huge_increase  }
				add_opinion_modifier = { target = AST modifier = huge_increase  }
			}
			AST = { 
				add_opinion_modifier = { target = NZL modifier = huge_increase  }
				add_opinion_modifier = { target = NZL modifier = huge_increase  }
				add_opinion_modifier = { target = NZL modifier = huge_increase  }
			}
			SPR = {
				add_opinion_modifier = { target = ENG modifier = embargo }
				add_opinion_modifier = { target = ENG modifier = sanctions_relations }
				add_opinion_modifier = { target = ENG modifier = large_decrease }
				add_opinion_modifier = { target = ENG modifier = hostile_status }
				add_opinion_modifier = { target = RAJ modifier = embargo }
				add_opinion_modifier = { target = RAJ modifier = sanctions_relations }
				add_opinion_modifier = { target = RAJ modifier = large_decrease }
				add_opinion_modifier = { target = RAJ modifier = hostile_status }
				add_opinion_modifier = { target = CAN modifier = embargo }
				add_opinion_modifier = { target = CAN modifier = sanctions_relations }
				add_opinion_modifier = { target = CAN modifier = large_decrease }
				add_opinion_modifier = { target = CAN modifier = hostile_status }
				add_opinion_modifier = { target = SOV modifier = embargo }
				add_opinion_modifier = { target = SOV modifier = sanctions_relations }
				add_opinion_modifier = { target = SOV modifier = large_decrease }
				add_opinion_modifier = { target = SOV modifier = hostile_status }
				add_opinion_modifier = { target = SAF modifier = embargo }
				add_opinion_modifier = { target = SAF modifier = sanctions_relations }
				add_opinion_modifier = { target = SAF modifier = large_decrease }
				add_opinion_modifier = { target = SAF modifier = hostile_status }
				add_opinion_modifier = { target = AST modifier = embargo }
				add_opinion_modifier = { target = AST modifier = sanctions_relations }
				add_opinion_modifier = { target = AST modifier = large_decrease }
				add_opinion_modifier = { target = AST modifier = hostile_status }
				add_opinion_modifier = { target = NZL modifier = embargo }
				add_opinion_modifier = { target = NZL modifier = sanctions_relations }
				add_opinion_modifier = { target = NZL modifier = large_decrease }
				add_opinion_modifier = { target = NZL modifier = hostile_status }
				add_opinion_modifier = { target = USA modifier = embargo }
				add_opinion_modifier = { target = USA modifier = sanctions_relations }   
				add_opinion_modifier = { target = USA modifier = large_decrease }
				add_opinion_modifier = { target = USA modifier = hostile_status } 
				add_opinion_modifier = { target = VEN modifier = embargo }
				add_opinion_modifier = { target = VEN modifier = sanctions_relations }   
				add_opinion_modifier = { target = VEN modifier = large_decrease }
				add_opinion_modifier = { target = VEN modifier = hostile_status }  				
			}
			VEN = { 
				add_opinion_modifier = { target = SPR modifier = embargo }
				add_opinion_modifier = { target = SPR modifier = sanctions_relations }
				add_opinion_modifier = { target = SPR modifier = large_decrease }
				add_opinion_modifier = { target = SPR modifier = hostile_status }
			}
			SOV = { 
				add_opinion_modifier = { target = SPR modifier = embargo }
				add_opinion_modifier = { target = SPR modifier = sanctions_relations }
				add_opinion_modifier = { target = SPR modifier = large_decrease }
				add_opinion_modifier = { target = SPR modifier = hostile_status }
			}
			CAN = { 
				add_opinion_modifier = { target = SPR modifier = embargo }
				add_opinion_modifier = { target = SPR modifier = sanctions_relations }
				add_opinion_modifier = { target = SPR modifier = large_decrease }
				add_opinion_modifier = { target = SPR modifier = hostile_status }
			}
			ENG = { 
				add_opinion_modifier = { target = SPR modifier = embargo }
				add_opinion_modifier = { target = SPR modifier = sanctions_relations }
				add_opinion_modifier = { target = SPR modifier = large_decrease }
				add_opinion_modifier = { target = SPR modifier = hostile_status }
			}
			RAJ = { 
				add_opinion_modifier = { target = SPR modifier = embargo }
				add_opinion_modifier = { target = SPR modifier = sanctions_relations }
				add_opinion_modifier = { target = SPR modifier = large_decrease }
				add_opinion_modifier = { target = SPR modifier = hostile_status }
			}
			SAF = { 
				add_opinion_modifier = { target = SPR modifier = embargo }
				add_opinion_modifier = { target = SPR modifier = sanctions_relations }
				add_opinion_modifier = { target = SPR modifier = large_decrease }
				add_opinion_modifier = { target = SPR modifier = hostile_status }
			}
			AST = { 
				add_opinion_modifier = { target = SPR modifier = embargo }
				add_opinion_modifier = { target = SPR modifier = sanctions_relations }
				add_opinion_modifier = { target = SPR modifier = large_decrease }
				add_opinion_modifier = { target = SPR modifier = hostile_status }
			}
			NZL = { 
				add_opinion_modifier = { target = SPR modifier = embargo }
				add_opinion_modifier = { target = SPR modifier = sanctions_relations }
				add_opinion_modifier = { target = SPR modifier = large_decrease }
				add_opinion_modifier = { target = SPR modifier = hostile_status }
			}
			USA = { 
				add_opinion_modifier = { target = SPR modifier = embargo }
				add_opinion_modifier = { target = SPR modifier = sanctions_relations }
				add_opinion_modifier = { target = SPR modifier = large_decrease }
				add_opinion_modifier = { target = SPR modifier = hostile_status }
			}

			
			
			#### Countries are given small amounts of starting navy XP to make some starting ship templates. Japan gets more because it is fuel deprived and can't really afford to train its navy early for navy XP. #### 

			USA = { 
				navy_experience = 33
			}
			ENG = { 
				navy_experience = 33
			}
			ITA = { 
				navy_experience = 33
			}
			GER = { 
				navy_experience = 33
			}
			SOV = { 
				navy_experience = 33
			}
			FRA = { 
				navy_experience = 33
			}
			JAP = { 
				navy_experience = 99
			}
			AST = { 
				navy_experience = 33
			}
			CAN = { 
				navy_experience = 33
			}
			SAF = { 
				navy_experience = 33
			}
			RAJ = { 
				navy_experience = 33
			}
			NZL = { 
				navy_experience = 33
			}
       

		#### Annexing Manchukuo immediately to Japan if it starts the game as AI. In this case, Japan gets some of the industry from focuses Manchukuo would have done if it were a player. Although Japan gets this industry up front, it is less than the focus factories a human Manchukuo player can get. Given that Japan can use this for ongoing construction, Asian Axis should end up with about the same industry as you would get with a good Manchu player who properly develops it ####

		if = { 
			limit = { 
				NOT = { has_global_flag = manchukuo_started_ai } 
				date < 1936.1.2
				MAN = { is_ai = yes }
			}
			set_global_flag = manchukuo_started_ai 
			JAP = {	
				add_research_slot = 1
				annex_country = {
							target = MAN
							transfer_troops = yes
				}
			}
			
			610 = {
				add_manpower = 25417
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
				set_state_flag = MAN_invite_japanese_settlers_2IC
			}
			716 = {
				add_manpower = 25417
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
				set_state_flag = MAN_invite_japanese_settlers_2IC
			}
			every_state = {
				limit = {
					is_core_of = MAN
				}
				add_extra_state_shared_building_slots = 2
			}
			715 = {
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
				set_state_flag = MAN_expand_the_textile_industry_IC				
			}
			328 = {
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
				set_state_flag = MAN_invite_japanese_investors_IC
			}
			716 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = arms_factory
					level = 1
					instant_build = yes
				}
			}
			716 = {
					add_building_construction = {
						type = infrastructure
						level = 2
						instant_build = yes
					}
				}
			328 = {
					add_building_construction = {
						type = infrastructure
						level = 2
						instant_build = yes
					}
				}
			610 = {
					add_building_construction = {
						type = infrastructure
						level = 2
						instant_build = yes
					}
				}
			717 = {
					add_building_construction = {
						type = infrastructure
						level = 2
						instant_build = yes
					}
				}
			#### Remove Manchukuo cores so that it is not possible for Japan to release Manchukuo and then re-annex it for another extra research slot ####
			MAN = {
				remove_state_core = 328			
				remove_state_core = 610
				remove_state_core = 611				
				remove_state_core = 612				
				remove_state_core = 714				
				remove_state_core = 715				
				remove_state_core = 716				
				remove_state_core = 717
				remove_state_core = 745				
				remove_state_core = 761	
				remove_state_core = 794				
			}
		}




			

		}
	}

	#THIS PREVENTS USA FROM JOINING THE ALLIES UNTIL IT IS EITHER 1941 OR UNLESS A SEALION HAS TAKEN AT LEAST 1 STATE IN THE UK. This prevents various cheesy stuff that is possible with pre-war military access/docking rights
	on_daily = { 
		effect = {
			 if = {
                limit = {
					TAG = USA
					AND = {
						date < 1941.1.1
						ENG = { surrender_progress < 0.5 }
						USA = { is_in_faction = yes }
					}
				}
				USA = { leave_faction = yes }
				PHI = { leave_faction = yes }
				USA = { country_event = { id = gduevents.26 } }
			}
		}
	}

	#THIS IS THE AIRBASE LIMITER. 
	on_daily = { 
		effect = {
			 if = {
                limit = {
       
                 NOT = { has_global_flag = airbase_limiter_ran } }
				for_each_scope_loop = {
					array = global.small_airbase_list
					if = {
						limit = { 
							air_base > 1 
						}
						remove_building = { 
							type = air_base 
							level = 1 
						}
						controller = { 
							PREV = { save_event_target_as = GDU_badairport1 } 
							country_event = { id = gduairlimiter.1 }
						}
					}
			
				}
				for_each_scope_loop = {
					array = global.medium_airbase_list
					if = {
						limit = { 
							air_base > 3 
						}
						remove_building = { 
							type = air_base 
							level = 1 
						}
						controller = { 
							PREV = { save_event_target_as = GDU_badairport2 } 
							country_event = { id = gduairlimiter.2 }
						}
					}
			
				}
				set_global_flag = { flag = airbase_limiter_ran value = 1 days = 1 }
			}	
		}
	}

		
	
	#### This thing gives JAP EXP when they conquer things in China. Also, Spanish Civil War. ####
	
	on_state_control_changed = {
		effect = {
		
			if = {
				limit = {
					original_tag = JAP 
					FROM.FROM = {
						is_core_of = CHI
						NOT = { is_core_of = MAN } 
						NOT = { has_state_flag = GDU_JAP_xp_acquired } 
					}
				}
				FROM.FROM = { 
					set_state_flag = GDU_JAP_xp_acquired 
				}
				army_experience = 50
				air_experience = 50
				navy_experience = 25 
			}
			
		    if = {
                limit = {
                    tag = SPR 
                    has_government = fascism
                    has_volunteers_amount_from = { 
                        tag = GER 
                        count > 0 
                    }
                    FROM = {
                        original_tag = SPR
                        NOT = { has_government = fascism }
                    }
                    FROM.FROM = {
                        is_core_of = SPR
                        NOT = { has_state_flag = GDU_AXIS_xp_acquired } 
                    }
                }
                FROM.FROM = { 
                    set_state_flag = GDU_AXIS_xp_acquired 
                }
                GER = { 
                    army_experience = 40
                    air_experience = 40 
                }
				ITA = { 
                    army_experience = 40
                    air_experience = 40 
                }
            }
			
			if = {
                limit = {
                    original_tag = SPR 
                    has_government = communism 
                    has_volunteers_amount_from = { 
                        tag = SOV 
                        count > 0 
                    }
                    FROM = {
                        original_tag = SPR
                        NOT = { has_government = communism }
                    }
                    FROM.FROM = {
                        is_core_of = SPR
                        NOT = { has_state_flag = GDU_Soviet_XP_acquired } 
                    }
                }
                FROM.FROM = { 
                    set_state_flag = GDU_Soviet_XP_acquired 
                }
                SOV = { 
                    army_experience = 50
                    air_experience = 50
                }
            }	
		}
	}
	
	
	#### This thing gives Soviets 100 army XP each time they finish a new land doctrine tech. The purpose is to allow them to take the XP boost to land doctrine research for every tech, allowing the purge penalty on land doctrine to be higher and making it effectively impossible for Soviets to rush land doctrine more than desired for balance. ####
	
	on_daily = {
		effect = {
		
			if = {
				limit = {
					original_tag = SOV 
					NOT = { has_global_flag = GDU_SOV_got_tier1_doctrine_XP } 
					SOV_land_doctrine_tier_1_trigger = yes
				}
				FROM.FROM = { 
					set_global_flag = GDU_SOV_got_tier1_doctrine_XP 
				}
				army_experience = 200
			}
			
			if = {
				limit = {
					original_tag = SOV 
					NOT = { has_global_flag = GDU_SOV_got_tier2_doctrine_XP } 
					SOV_land_doctrine_tier_2_trigger = yes
				}
				FROM.FROM = { 
					set_global_flag = GDU_SOV_got_tier2_doctrine_XP 
				}
				army_experience = 200
			}

			if = {
				limit = {
					original_tag = SOV 
					NOT = { has_global_flag = GDU_SOV_got_tier3_doctrine_XP } 
					SOV_land_doctrine_tier_3_trigger = yes
				}
				FROM.FROM = { 
					set_global_flag = GDU_SOV_got_tier3_doctrine_XP 
				}
				army_experience = 200
			}

			if = {
				limit = {
					original_tag = SOV 
					NOT = { has_global_flag = GDU_SOV_got_tier4_doctrine_XP } 
					SOV_land_doctrine_tier_4_trigger = yes
				}
				FROM.FROM = { 
					set_global_flag = GDU_SOV_got_tier4_doctrine_XP 
				}
				army_experience = 200
			}

			if = {
				limit = {
					original_tag = SOV 
					NOT = { has_global_flag = GDU_SOV_got_tier5_doctrine_XP } 
					SOV_land_doctrine_tier_5_trigger = yes
				}
				FROM.FROM = { 
					set_global_flag = GDU_SOV_got_tier5_doctrine_XP 
				}
				army_experience = 200
			}

			if = {
				limit = {
					original_tag = SOV 
					NOT = { has_global_flag = GDU_SOV_got_tier6_doctrine_XP } 
					SOV_land_doctrine_tier_6_trigger = yes
				}
				FROM.FROM = { 
					set_global_flag = GDU_SOV_got_tier6_doctrine_XP 
				}
				army_experience = 200
			}

			if = {
				limit = {
					original_tag = SOV 
					NOT = { has_global_flag = GDU_SOV_got_tier7_doctrine_XP } 
					SOV_land_doctrine_tier_7_trigger = yes
				}
				FROM.FROM = { 
					set_global_flag = GDU_SOV_got_tier7_doctrine_XP 
				}
				army_experience = 200
			}

			if = {
				limit = {
					original_tag = SOV 
					NOT = { has_global_flag = GDU_SOV_got_tier8_doctrine_XP } 
					SOV_land_doctrine_tier_8_trigger = yes
				}
				FROM.FROM = { 
					set_global_flag = GDU_SOV_got_tier8_doctrine_XP 
				}
				army_experience = 200
			}

			if = {
				limit = {
					original_tag = SOV 
					NOT = { has_global_flag = GDU_SOV_got_tier9_doctrine_XP } 
					SOV_land_doctrine_tier_9_trigger = yes
				}
				FROM.FROM = { 
					set_global_flag = GDU_SOV_got_tier9_doctrine_XP 
				}
				army_experience = 200
			}			
			
		}
	}	
	
	on_declare_war = {
		effect = {
			
			if = {
				limit = {
					NOT = { has_global_flag = GDU_Battle_Of_France_Missions_Activated }
					OR = {
						AND = {
							FROM = {
								tag = BEL 
							}
							ROOT = { tag = GER }
						}
						AND = {
							FROM = {
								tag = FRA 
							}
							ROOT = { tag = ITA }
						}						
					}	
				}
				hidden_effect = {
					GER = {
						activate_mission = GER_triumph_france1
						activate_mission = GER_triumph_france2
						activate_mission = GER_triumph_france3
						activate_mission = GER_triumph_france4
						activate_mission = GER_triumph_france5
						activate_mission = GER_triumph_france6
						activate_mission = GER_triumph_france7
						activate_mission = GER_triumph_france8
						activate_mission = GER_triumph_france9
						activate_mission = GER_triumph_france10					
					}
					FRA = { 
						activate_mission = FRA_evacuate_france1
						activate_mission = FRA_evacuate_france2
						activate_mission = FRA_evacuate_france3
						activate_mission = FRA_evacuate_france4
						activate_mission = FRA_evacuate_france5
						activate_mission = FRA_evacuate_france6
						activate_mission = FRA_evacuate_france7
						activate_mission = FRA_evacuate_france8
						activate_mission = FRA_evacuate_france9
						activate_mission = FRA_evacuate_france10						
					}
					FRA =  { country_event = { id = gduevents.19 days = 1 } } #Warn France to hold.
					set_global_flag = GDU_Battle_Of_France_Missions_Activated
				}
			}
		}
		
	}
	
	
	on_declare_war = {
		effect = {
			if = {
				limit = {
					FROM = {
						tag = SOV 
					}
					ROOT = { tag = GER }
				}
				SOV = {
activate_mission = SOV_relocate_industry_from_bialyostok
activate_mission = SOV_relocate_industry_from_brest
activate_mission = SOV_relocate_industry_from_bryansk
activate_mission = SOV_relocate_industry_from_cherkasy
activate_mission = SOV_relocate_industry_from_crimea
activate_mission = SOV_relocate_industry_from_dnipropetrovsk
activate_mission = SOV_relocate_industry_from_gomel
activate_mission = SOV_relocate_industry_from_harju
activate_mission = SOV_relocate_industry_from_ivanovo
activate_mission = SOV_relocate_industry_from_kalinin
activate_mission = SOV_relocate_industry_from_kaunas
activate_mission = SOV_relocate_industry_from_kharkov
activate_mission = SOV_relocate_industry_from_kiev
activate_mission = SOV_relocate_industry_from_kursk
activate_mission = SOV_relocate_industry_from_kurzeme
activate_mission = SOV_relocate_industry_from_leningrad
activate_mission = SOV_relocate_industry_from_lvov
activate_mission = SOV_relocate_industry_from_minsk
activate_mission = SOV_relocate_industry_from_moscow
activate_mission = SOV_relocate_industry_from_novgorod
activate_mission = SOV_relocate_industry_from_nowogrodek
activate_mission = SOV_relocate_industry_from_odessa
activate_mission = SOV_relocate_industry_from_orel
activate_mission = SOV_relocate_industry_from_rostov
activate_mission = SOV_relocate_industry_from_ryazan
activate_mission = SOV_relocate_industry_from_rzhev
activate_mission = SOV_relocate_industry_from_siauliai
activate_mission = SOV_relocate_industry_from_smolensk
activate_mission = SOV_relocate_industry_from_stalino
activate_mission = SOV_relocate_industry_from_tartu
activate_mission = SOV_relocate_industry_from_tula
activate_mission = SOV_relocate_industry_from_vidzeme
activate_mission = SOV_relocate_industry_from_voronezh
activate_mission = SOV_relocate_industry_from_voroshilovgrad
activate_mission = SOV_relocate_industry_from_wilejka
activate_mission = SOV_relocate_industry_from_wilno
activate_mission = SOV_relocate_industry_from_yaroslavl
activate_mission = SOV_relocate_industry_from_zaporozhe
				}
			}

		}
		
	}	
	
	#### Make the Battle of France Missions activate if France loses a state, even if somehow Germany has not declared war on Belgium. Failsafe to stop people from getting around it by avoiding declaring war on Belgium in various ways. ####
	
	on_state_control_changed = {
		effect = {
		
			if = {
				limit = {
					NOT = { has_global_flag = GDU_Battle_Of_France_Missions_Activated }
					OR = {
						original_tag = GER
						original_tag = ITA
						original_tag = HUN
						original_tag = ROM
						original_tag = BUL
						original_tag = FIN
						original_tag = SPR					
					}
					OR = {
						FROM.FROM = {
							is_core_of = FRA
						}
						FROM.FROM = {
							is_core_of = BEL
						}
						FROM.FROM = {
							is_core_of = HOL
						}
						FROM.FROM = {
							is_core_of = LUX
						}						
					}
				}
				hidden_effect = {
					GER = {
						activate_mission = GER_triumph_france1
						activate_mission = GER_triumph_france2
						activate_mission = GER_triumph_france3
						activate_mission = GER_triumph_france4
						activate_mission = GER_triumph_france5
						activate_mission = GER_triumph_france6
						activate_mission = GER_triumph_france7
						activate_mission = GER_triumph_france8
						activate_mission = GER_triumph_france9
						activate_mission = GER_triumph_france10					
					}
					FRA = { 
						activate_mission = FRA_evacuate_france1
						activate_mission = FRA_evacuate_france2
						activate_mission = FRA_evacuate_france3
						activate_mission = FRA_evacuate_france4
						activate_mission = FRA_evacuate_france5
						activate_mission = FRA_evacuate_france6
						activate_mission = FRA_evacuate_france7
						activate_mission = FRA_evacuate_france8
						activate_mission = FRA_evacuate_france9
						activate_mission = FRA_evacuate_france10						
					}
					FRA =  { country_event = { id = gduevents.19 days = 1 } } #Warn France to hold. 
					set_global_flag = GDU_Battle_Of_France_Missions_Activated
				} 
			}
			

				
		}
	}
	
	
	
	
	#### If Soviets start advancing beyond the pre-Barbarossa boundaries into Poland/East Prussia after 1942 but before 1943, that is sufficient to trigger Totaler Krieg for Germany to give it one last gasping breath of life ####
	
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					NOT = { has_global_flag = GDU_eastern_front_Axis_danger }
					date > 1942.1.1
					OR = {
						original_tag = SOV					
					}
					OR = {
						controls_state = 188 # Memel
						controls_state = 5 # Ermland-Masuren
						controls_state = 763 # Konigsberg
						controls_state = 788 # East Prussia
						controls_state = 98 # Plock
						controls_state = 10 # Warsazawa
						controls_state = 92 # Lublin
						controls_state = 88 # Krakow
						
						# Also adding more states in Northern Germany/Denmark. Soviet meme naval invasions of Northern Germany can trigger this
						
						controls_state = 85 # Danzig
						controls_state = 63 # Hinterpommern
						controls_state = 62 # Vorpommern
						controls_state = 61 # Mecklenburg
						controls_state = 58 # Schleswig-Holstein
						controls_state = 37 # Sjaelland DK
						controls_state = 99 # Jutland DK
						controls_state = 64 # Berlin						
						
					}
				}
				hidden_effect = {
					set_global_flag = GDU_eastern_front_Axis_danger
				} 
			}
			

				
		}
	}
	
	
	#### If Allies are advancing into Northern Italy (anything from Bologna to the north, i.e. of the Gothic Line) AND if Germany has also bothered to do the Gothic Line Focus, then that is enough to trigger Totaler Krieg for Germany ####
	
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					NOT = { has_global_flag = GDU_gothic_line_breached }
					date > 1941.1.1
					OR = {
						original_tag = USA
						original_tag = ENG
						original_tag = FRF
						original_tag = CAN
						original_tag = SAF
						original_tag = RAJ
						original_tag = AST
						original_tag = NZL						
					}
					OR = {
						controls_state = 158 # Piedmont
						controls_state = 159 # Lombardy
						controls_state = 39 # South Tyrol
						controls_state = 160 # Veneto
						controls_state = 736 # Istria
						controls_state = 161 # Emilia Romagna				
					}
				}
				hidden_effect = {
					set_global_flag = GDU_gothic_line_breached
				} 
			}
			

				
		}
	}	
	
	
	
	#### Check if the Stalin Line has fallen; give Soviets a buff after it has. Though this is artificial, this is intended as a temporary feature to be gradually phased out while Barbarossa balance is improved in a more natural way ####
	
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					NOT = { has_global_flag = GDU_Stalin_Line_Fallen }
					NOT = {
						SOV = { 
							has_completed_focus = SOV_defense_of_stalingrad
						}	
					}
					date > 1941.1.1
					OR = {
						original_tag = GER
						original_tag = ITA
						original_tag = HUN
						original_tag = ROM
						original_tag = BUL
						original_tag = FIN
						original_tag = SPR					
					}
					OR = {
						controls_state = 581
						controls_state = 262
						controls_state = 214
						controls_state = 351
						controls_state = 818						
						controls_state = 264       #Northern Coast to Leningrad#
						controls_state = 244
						controls_state = 195
						controls_state = 208
						
						controls_state = 191
						controls_state = 13
						controls_state = 209
						controls_state = 210		#States behind Dvina/Dnieper proper#
						controls_state = 242
						controls_state = 243
						controls_state = 241
						controls_state = 193
						controls_state = 259
						controls_state = 221
						controls_state = 227
						controls_state = 137
						
						controls_state = 218		#Rostov to Cauacasus/Baku#
						controls_state = 234
						controls_state = 810
						controls_state = 812						
						controls_state = 233
						controls_state = 231
						controls_state = 230
						controls_state = 814						
						controls_state = 229
						controls_state = 813
						controls_state = 232

						
						controls_state = 584		#Central Asia and Far East#
						controls_state = 405
						controls_state = 586
						controls_state = 587
						controls_state = 585
						controls_state = 742
						controls_state = 732						
						controls_state = 408
						controls_state = 409
						controls_state = 560
						controls_state = 562
						controls_state = 657
						controls_state = 561						
					}
				}
				hidden_effect = {
					SOV = {
						add_ideas = GDU_SOV_Stalin_Line_Fallen				
					}
					set_global_flag = GDU_Stalin_Line_Fallen
				} 
			}
			

				
		}
	}
	
	
	
	#### Check if core parts of the Soviet heartland like Leningrad/Moscow/Stalingrad are threatened; give Soviets a buff after they are. Though this is artificial, this is intended as a temporary feature to be gradually phased out while Barbarossa balance is improved in a more natural way  ####
	
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					NOT = { has_global_flag = GDU_SOV_Danger_To_Heartland }
					NOT = {
						SOV = { 
							has_completed_focus = SOV_defense_of_stalingrad
						}	
					}					
					date > 1941.1.1
					OR = {
						original_tag = GER
						original_tag = ITA
						original_tag = HUN
						original_tag = ROM
						original_tag = BUL
						original_tag = FIN
						original_tag = SPR					
					}
					OR = {
						controls_state = 581
						controls_state = 262
						controls_state = 214
						controls_state = 351
						controls_state = 818												
						controls_state = 264       #Northern Coast to Leningrad#
						controls_state = 244
						controls_state = 195
						controls_state = 208

						controls_state = 263
						controls_state = 246
						controls_state = 795
						controls_state = 205		#Line from Luga to Vyazma to Kursk to Rostov#
						controls_state = 222
						controls_state = 220
						controls_state = 240
						controls_state = 228

						controls_state = 218		#Rostov to Cauacasus/Baku#
						controls_state = 234
						controls_state = 810
						controls_state = 812						
						controls_state = 233
						controls_state = 231
						controls_state = 230
						controls_state = 814						
						controls_state = 229
						controls_state = 813
						controls_state = 232
						
						controls_state = 584		#Central Asia and Far East#
						controls_state = 405
						controls_state = 586
						controls_state = 587
						controls_state = 585
						controls_state = 742
						controls_state = 732						
						controls_state = 408
						controls_state = 409
						controls_state = 560
						controls_state = 562
						controls_state = 657
						controls_state = 561

					}
				}
				hidden_effect = {
					SOV = {
						add_ideas = GDU_SOV_Danger_To_Heartland				
					}
					set_global_flag = GDU_SOV_Danger_To_Heartland
				}
			}
			

				
		}
	}	
	
	
	
	
	
	
	#### Check if core parts of the Soviet heartland from Tikhvin to Moscow itself to Penza to the outskirts of Stalingrad have fallen (Leningrad can fall without triggering this in case Finland takes it early); give Soviets a buff after they have. Though this is artificial, this is intended as a temporary feature to be gradually phased out while Barbarossa balance is improved in a more natural way ####
	
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					NOT = { has_global_flag = GDU_SOV_Heartland_Falling }
					NOT = {
						SOV = { 
							has_completed_focus = SOV_defense_of_stalingrad
						}	
					}					
					date > 1941.1.1
					OR = {
						original_tag = GER
						original_tag = ITA
						original_tag = HUN
						original_tag = ROM
						original_tag = BUL
						original_tag = FIN
						original_tag = SPR
					}
					OR = {
						controls_state = 581
						controls_state = 262
						controls_state = 214
						controls_state = 351	   #Northern Coast to Vologda#

						controls_state = 247
						controls_state = 248
						controls_state = 219
						controls_state = 253		#Core areas around Moscow to the outskirts of Stalingrad#
						controls_state = 255
						controls_state = 252
						controls_state = 239
						controls_state = 265
						controls_state = 245
						controls_state = 238
						controls_state = 235
						
						controls_state = 233		#Cauacasus/Baku#
						controls_state = 231
						controls_state = 230
						controls_state = 229
						
						controls_state = 584		#Central Asia and Far East#
						controls_state = 405
						controls_state = 586
						controls_state = 587
						controls_state = 585
						controls_state = 742
						controls_state = 732
						controls_state = 408
						controls_state = 409
						controls_state = 560
						controls_state = 562
						controls_state = 657
						controls_state = 561

					}
				}
				hidden_effect = {
					SOV = {
						add_ideas = GDU_SOV_Heartland_Falling				
					}
					set_global_flag = GDU_SOV_Heartland_Falling
				}
			}
			

				
		}
	}		
	
	
	
	
	
	
	
	
	
	#### Check for DDay. If a DDay occurs, Axis gets a mission to defeat the DDay within 1 year; if they defeat it, Axis gets some buffs and Allies lose stability/war support because of the failed DDay. Germany's Totaler Krieg event also gets triggered upon DDay, if it has not already been triggered. The idea is that this gives Allies realistic incentives for DDay; they shouldn't want to launch one until they are sure that they will succeed, because in reality a failed DDay would have been a disaster and would have resulted in large amounts of lost/captured equipment (like Dunkirk) and would have been a PR disaster for the Democracies that relied on popular support for continuing the war. ####
	
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					NOT = { has_global_flag = GDU_dday_started }				
					date > 1941.1.1
					OR = {
						original_tag = USA
						original_tag = ENG
						original_tag = CAN
						original_tag = SAF
						original_tag = RAJ
						original_tag = NZL
						original_tag = AST
						original_tag = FRF
						original_tag = HOL
						original_tag = BEL
						original_tag = LUX
						original_tag = DEN												
					}
					OR = {
						controls_state = 735 # Savoy
						controls_state = 21 # Provence
						controls_state = 18 # Languedoc
						controls_state = 31 # Midi Pyrenees
						controls_state = 19 # Aquitane
						controls_state = 23 # Poitou
						controls_state = 30 # Loire
						controls_state = 14 # Brittany
						controls_state = 15 # Normandy
						controls_state = 785 # Picardy
						controls_state = 29 # Nord-Pas-de-Calais
						controls_state = 6 # Vlaandern
						controls_state = 7 # Holland
						controls_state = 36 # Friesland
						controls_state = 56 # Weser-Ems
						controls_state = 59 # Hannover
						controls_state = 58 # Schleswig-Holstein
						controls_state = 99 # Jutland
						controls_state = 61 # Mecklenburg
						controls_state = 62 # Vorpommern
						controls_state = 63 # Hinterpommern
						controls_state = 85 # Danzig
						controls_state = 788 # East Prussia
						controls_state = 763 # Konigsberg
					}	
								
						
					}
				
				hidden_effect = {
					set_global_flag = GDU_dday_started
					GER = { 
						activate_mission = GER_defeat_dday					
					}
				}
			}
			}

			
		}
		
	

	# If Hungary, Romania, or Bulgaria capitulate prior to 1943 (but after 1941), that is sufficient to trigger Totaler Krieg for Germany to give Axis one last shot to recover.
	
	on_capitulation = {
		effect = {
		
			if = {
				limit = {
					tag = HUN
					date > 1941.1.1
				}
				set_global_flag = GDU_eastern_front_Axis_danger
			}
		}
	}

	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = ROM
					date > 1941.1.1
				}
				set_global_flag = GDU_eastern_front_Axis_danger
			}
		}
	}
	
	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = BUL
					date > 1941.1.1
				}
				set_global_flag = GDU_eastern_front_Axis_danger
			}			
		}
	}



	# Check if Allies have capitulated and create missions to liberate them if they have and apply penalties/bonuses accordingly #

			# When Iraq capitulates, UK annexes it and gets its troops/navy #

	on_capitulation = {
		effect = {		
			if = {
				limit = {
					tag = IRQ
				}
				set_global_flag = GDU_IRQ_capitulated
				IRQ = { 
					transfer_navy = { 
						target = AST 
					}
				}
				IRQ = { 					country_event = { id = gduannexations.9 days = 10 }  }			}
		}
	}


			# When Belgium capitulates, UK annexes it and gets its troops/navy #

	on_capitulation = {
		effect = {		
			if = {
				limit = {
					tag = BEL
				}
				set_global_flag = GDU_BEL_capitulated
				BEL = { 
					transfer_navy = { 
						target = CAN 
					}
				}
				BEL = { 					country_event = { id = gduannexations.1 days = 10 }  }
			}
		}
	}			

			# When Luxembourg capitulates, UK annexes it and gets its troops/navy #

	on_capitulation = {
		effect = {			
			if = {
				limit = {
					tag = LUX
				}
				set_global_flag = GDU_LUX_capitulated
				LUX = { 
					transfer_navy = { 
						target = CAN 
					}
				}
				LUX = { 					country_event = { id = gduannexations.2 days = 10 }  }
			}
		}
	}					
			# When Holland capitulates, UK annexes it and gets its troops/navy #

	on_capitulation = {
		effect = {			
			if = {
				limit = {
					tag = HOL
				}
				set_global_flag = GDU_HOL_capitulated
				HOL = { 
					transfer_navy = { 
						target = AST 
					}
				}
				HOL = { 					country_event = { id = gduannexations.3 days = 10 }  }
			}
		}
	}		
	
			# When Denmark capitulates, UK annexes it and gets its troops/navy #

	on_capitulation = {
		effect = {			
			if = {
				limit = {
					tag = DEN
				}
				set_global_flag = GDU_DEN_capitulated
				DEN = { 
					transfer_navy = { 
						target = CAN 
					}
				}
				DEN = { 					country_event = { id = gduannexations.4 days = 10 }  }			}						
		}
	}		
	
			# When Norway capitulates, UK annexes it and gets its troops/navy #

	on_capitulation = {
		effect = {			
			if = {
				limit = {
					tag = NOR
				}
				set_global_flag = GDU_NOR_capitulated
				NOR = { 
					transfer_navy = { 
						target = CAN 
					}
				}
				NOR = { 					country_event = { id = gduannexations.5 days = 10 }  }			}					
		}
	}		
	
			# When Greece capitulates, UK annexes it and gets its troops/navy #

	on_capitulation = {
		effect = {			
			if = {
				limit = {
					tag = GRE
					NOT = { has_global_flag = GDU_GRE_capitulated }					
				}
				set_global_flag = GDU_GRE_capitulated
				

								
				ITA = {
					transfer_state = 185
					transfer_state = 186									
					}				
				
				GRE = { 
					transfer_navy = { 
						target = AST 
					}
				}
				
				GRE = { 					country_event = { id = gduannexations.11 days = 3 }  }												
				
				GRE = { 					country_event = { id = gduannexations.6 days = 10 }  }			}					
		}
	}		
	
			# When Yugoslavia capitulates, UK annexes it and gets its troops/navy #

	on_capitulation = {
		effect = {	
			if = {
				limit = {
					tag = YUG
					NOT = { has_global_flag = GDU_YUG_capitulated }
				}
				set_global_flag = GDU_YUG_capitulated
				

				ITA = {
					transfer_state = 103
					transfer_state = 104				
					transfer_state = 105
					transfer_state = 109
					transfer_state = 789					
					}
			
				
				YUG = { 
					transfer_navy = { 
						target = AST 
					}
				}
				
				YUG = { 					country_event = { id = gduannexations.10 days = 3 }  }							
				
				YUG = { 					country_event = { id = gduannexations.7 days = 10 }  }			}				
		}
	}		
	
			# When Poland capitulates, UK annexes it and gets its troops/navy #

	on_capitulation = {
		effect = {	
			if = {
				limit = {
					tag = POL
				}
				set_global_flag = GDU_POL_capitulated
				POL = { 
					transfer_navy = { 
						target = CAN 
					}
				}
				POL = { 					country_event = { id = gduannexations.8 days = 100 }  }			}				
		}
	}					
			

			
		
		
		
		
		
		
			# If Australia capitulated to Japan
	on_capitulation = {
		effect = {			
			if = {
				limit = {
					AND = {
						tag = AST
						OR = { 
							285 = { is_controlled_by = JAP } 
							285 = { is_controlled_by = MAN }
							285 = { is_controlled_by = SIA } 
						}
					}
				}
				
				JAP = {
					add_ideas = JAP_AST_resources
					add_timed_idea = { idea = JAP_triumph_AST_idea days = 730 } 
				}
				MAN = {
					add_ideas = JAP_AST_resources
					add_timed_idea = { idea = JAP_triumph_AST_idea days = 730 } 
				}
				SIA = {
					add_ideas = JAP_AST_resources
					add_timed_idea = { idea = JAP_triumph_AST_idea days = 730 } 
				}				
				
				USA = {
					activate_mission = liberate_AST_mission

					add_stability = -0.125
					add_war_support = -0.125
				}
				ENG = {
					activate_mission = liberate_AST_mission

					add_stability = -0.125
					add_war_support = -0.125					
				}
				CAN = {
					activate_mission = liberate_AST_mission

					add_stability = -0.125
					add_war_support = -0.125	
				}
				SAF = {
					activate_mission = liberate_AST_mission

					add_stability = -0.125
					add_war_support = -0.125	
				}
				RAJ = {
					activate_mission = liberate_AST_mission

					add_stability = -0.125
					add_war_support = -0.125	
				}
				NZL = {
					activate_mission = liberate_AST_mission

					add_stability = -0.125
					add_war_support = -0.125	
				}
				AST = {
					activate_mission = liberate_AST_mission

					add_stability = -0.125
					add_war_support = -0.125	
				}
				FRF = {
					activate_mission = liberate_AST_mission

					add_stability = -0.125
					add_war_support = -0.125	
				}				
			}
		}
	}	
	

			# If New Zealand capitulated to Japan
			
	on_capitulation = {
		effect = {			
			if = {
				limit = {
					AND = {
						tag = NZL
						OR = { 
							284 = { is_controlled_by = JAP } 
							284 = { is_controlled_by = MAN }
							284 = { is_controlled_by = SIA } 
						}
					}
				}
				
				JAP = {
					add_ideas = JAP_NZL_resources
					add_timed_idea = { idea = JAP_triumph_NZL_idea days = 730 } 
				}
				MAN = {
					add_ideas = JAP_NZL_resources
					add_timed_idea = { idea = JAP_triumph_NZL_idea days = 730 } 
				}
				SIA = {
					add_ideas = JAP_NZL_resources
					add_timed_idea = { idea = JAP_triumph_NZL_idea days = 730 } 
				}				
				
				USA = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06						
				}
				ENG = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				CAN = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				SAF = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				RAJ = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				NZL = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				AST = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				FRF = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}				
			}
		}
	}				
			


			# If Australia capitulated to Japan and Australia has annexed New Zealand, in which case New Zealand has effectively also capitulated...

	on_capitulation = {
		effect = {			
			if = {
				limit = {
					AND = {
						tag = AST
						284 = { is_core_of = AST }
						NOT = { JAP = { has_idea = JAP_NZL_resources } }
						OR = { 
							284 = { is_controlled_by = JAP } 
							284 = { is_controlled_by = MAN }
							284 = { is_controlled_by = SIA } 
						}
					}
				}
				
				JAP = {
					add_ideas = JAP_NZL_resources
					add_timed_idea = { idea = JAP_triumph_NZL_idea days = 730 } 
				}
				MAN = {
					add_ideas = JAP_NZL_resources
					add_timed_idea = { idea = JAP_triumph_NZL_idea days = 730 } 
				}
				SIA = {
					add_ideas = JAP_NZL_resources
					add_timed_idea = { idea = JAP_triumph_NZL_idea days = 730 } 
				}				
				
				USA = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06
				}
				ENG = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				CAN = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				SAF = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				RAJ = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				NZL = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				AST = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}
				FRF = {
					activate_mission = liberate_NZL_mission

					add_stability = -0.06
					add_war_support = -0.06	
				}				
			}
		}
	}				
			
			
			
			# If the British Raj capitulated to Japan

	on_capitulation = {
		effect = {			
			if = {
				limit = {
					AND = {
						tag = RAJ
						OR = { 
							439 = { is_controlled_by = JAP } 
							439 = { is_controlled_by = MAN }
							439 = { is_controlled_by = SIA } 
						}
					}
				}
				
				JAP = {
					add_ideas = JAP_RAJ_resources
					add_timed_idea = { idea = JAP_triumph_RAJ_idea days = 730 } 
				}
				MAN = {
					add_ideas = JAP_RAJ_resources
					add_timed_idea = { idea = JAP_triumph_RAJ_idea days = 730 } 
				}
				SIA = {
					add_ideas = JAP_RAJ_resources
					add_timed_idea = { idea = JAP_triumph_RAJ_idea days = 730 } 
				}				
				
				USA = {
					activate_mission = liberate_RAJ_mission

					add_stability = -0.15
					add_war_support = -0.15						
				}
				ENG = {
					activate_mission = liberate_RAJ_mission

					add_stability = -0.15
					add_war_support = -0.15							
				}
				CAN = {
					activate_mission = liberate_RAJ_mission

					add_stability = -0.15
					add_war_support = -0.15							
				}
				SAF = {
					activate_mission = liberate_RAJ_mission

					add_stability = -0.15
					add_war_support = -0.15							
				}
				RAJ = {
					activate_mission = liberate_RAJ_mission

					add_stability = -0.15
					add_war_support = -0.15							
				}
				NZL = {
					activate_mission = liberate_RAJ_mission

					add_stability = -0.15
					add_war_support = -0.15							
				}
				AST = {
					activate_mission = liberate_RAJ_mission

					add_stability = -0.15
					add_war_support = -0.15							
				}
				FRF = {
					activate_mission = liberate_RAJ_mission

					add_stability = -0.15
					add_war_support = -0.15							
				}				
			}
		}
	}	

			# If South Africa capitulated to Japan
			
	on_capitulation = {
		effect = {			
			if = {
				limit = {
					AND = {
						tag = SAF
						OR = { 
							275 = { is_controlled_by = JAP } 
							275 = { is_controlled_by = MAN }
							275 = { is_controlled_by = SIA } 
						}
					}
				}
				
				JAP = {
					add_ideas = JAP_SAF_resources
					add_timed_idea = { idea = JAP_triumph_SAF_idea days = 730 } 
				}
				MAN = {
					add_ideas = JAP_SAF_resources
					add_timed_idea = { idea = JAP_triumph_SAF_idea days = 730 } 
				}
				SIA = {
					add_ideas = JAP_SAF_resources
					add_timed_idea = { idea = JAP_triumph_SAF_idea days = 730 } 
				}				
				
				USA = {
					activate_mission = liberate_SAF_mission

					add_stability = -0.15
					add_war_support = -0.15							
				}
				ENG = {
					activate_mission = liberate_SAF_mission

					add_stability = -0.15
					add_war_support = -0.15		
				}
				CAN = {
					activate_mission = liberate_SAF_mission

					add_stability = -0.15
					add_war_support = -0.15		
				}
				SAF = {
					activate_mission = liberate_SAF_mission

					add_stability = -0.15
					add_war_support = -0.15		
				}
				RAJ = {
					activate_mission = liberate_SAF_mission

					add_stability = -0.15
					add_war_support = -0.15		
				}
				NZL = {
					activate_mission = liberate_SAF_mission

					add_stability = -0.15
					add_war_support = -0.15		
				}
				AST = {
					activate_mission = liberate_SAF_mission

					add_stability = -0.15
					add_war_support = -0.15		
				}
				FRF = {
					activate_mission = liberate_SAF_mission

					add_stability = -0.15
					add_war_support = -0.15		
				}				
			}			
			
		}
	}
	


	
	
	
	
	on_capitulation = {
		effect = {
			if = { 
				limit = { 
					AND = { 
						tag = IRQ
						OR = { 
							291 = { is_controlled_by = ENG } 
							291 = { is_controlled_by = USA }
							291 = { is_controlled_by = CAN } 
							291 = { is_controlled_by = SAF }
							291 = { is_controlled_by = AST }
							291 = { is_controlled_by = NZL } 
							291 = { is_controlled_by = RAJ } 
						}
					} 
						
						
				}
				ENG = { 
					annex_country = {
						target = IRQ 
						transfer_troops = no 
					}
					set_state_controller = 291 
				} 
			}
			
			if = { 
				limit = { 
					AND = { 
						tag = DEN 
						NOT = { has_global_flag = denmark_dead } 
					}
				}
				
				set_global_flag = denmark_dead 
				
			} 
			
			
		}
	}

}